source('./R/process_BSM_events.R')

cat('getting rates/events for mammals','\n')
results.BSM.afrotrop.real.mammals<-readRDS('./output/mammals/immigration/whole_realms/afrotrop/afrotrop.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.afrotrop.real.mammals<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.afrotrop.real.mammals[[2]],name='afrotrop',speciation.rate.treefile='./output/mammals/trees/afrotrop_speciationrates.tree')
BSMoutput.afrotrop.control.mammals<-readRDS('./output/mammals/immigration/controls/afrotrop/afrotrop_BSMcontrol_output_2my_full.RDS')
BSMoutput.afrotrop.control.rates.mammals<-lapply(BSMoutput.afrotrop.control.mammals,function(x)x[[1]])
BSMoutput.afrotrop.control.events.mammals<-lapply(BSMoutput.afrotrop.control.mammals,function(x)x[[2]])

results.BSM.austral.real.mammals<-readRDS('./output/mammals/immigration/whole_realms/austral/austral.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.austral.real.mammals<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.austral.real.mammals[[2]],name='austral',speciation.rate.treefile='./output/mammals/trees/austral_speciationrates.tree')
BSMoutput.austral.control.mammals<-readRDS('./output/mammals/immigration/controls/austral/austral_BSMcontrol_output_2my_full.RDS')
BSMoutput.austral.control.rates.mammals<-lapply(BSMoutput.austral.control.mammals,function(x)x[[1]])
BSMoutput.austral.control.events.mammals<-lapply(BSMoutput.austral.control.mammals,function(x)x[[2]])

results.BSM.indo.real.mammals<-readRDS('./output/mammals/immigration/whole_realms/indo/indo.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.indo.real.mammals<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.indo.real.mammals[[2]],name='indo',speciation.rate.treefile='./output/mammals/trees/indo_speciationrates.tree')
BSMoutput.indo.control.mammals<-readRDS('./output/mammals/immigration/controls/indo/indo_BSMcontrol_output_2my_full.RDS')
BSMoutput.indo.control.rates.mammals<-lapply(BSMoutput.indo.control.mammals,function(x)x[[1]])
BSMoutput.indo.control.events.mammals<-lapply(BSMoutput.indo.control.mammals,function(x)x[[2]])

results.BSM.nearctic.real.mammals<-readRDS('./output/mammals/immigration/whole_realms/nearctic/nearctic.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.nearctic.real.mammals<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.nearctic.real.mammals[[2]],name='nearctic',speciation.rate.treefile='./output/mammals/trees/nearctic_speciationrates.tree')
BSMoutput.nearctic.control.mammals<-readRDS('./output/mammals/immigration/controls/nearctic/nearctic_BSMcontrol_output_2my_full.RDS')
BSMoutput.nearctic.control.rates.mammals<-lapply(BSMoutput.nearctic.control.mammals,function(x)x[[1]])
BSMoutput.nearctic.control.events.mammals<-lapply(BSMoutput.nearctic.control.mammals,function(x)x[[2]])

results.BSM.neotrop.real.mammals<-readRDS('./output/mammals/immigration/whole_realms/neotrop/neotrop.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.neotrop.real.mammals<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.neotrop.real.mammals[[2]],name='neotrop',speciation.rate.treefile='./output/mammals/trees/neotrop_speciationrates.tree')
BSMoutput.neotrop.control.mammals<-readRDS('./output/mammals/immigration/controls/neotrop/neotrop_BSMcontrol_output_2my_full.RDS')
BSMoutput.neotrop.control.rates.mammals<-lapply(BSMoutput.neotrop.control.mammals,function(x)x[[1]])
BSMoutput.neotrop.control.events.mammals<-lapply(BSMoutput.neotrop.control.mammals,function(x)x[[2]])

results.BSM.palearctic.real.mammals<-readRDS('./output/mammals/immigration/whole_realms/palearctic/palearctic.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.palearctic.real.mammals<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.palearctic.real.mammals[[2]],name='palearctic',speciation.rate.treefile='./output/mammals/trees/palearctic_speciationrates.tree')
BSMoutput.palearctic.control.mammals<-readRDS('./output/mammals/immigration/controls/palearctic/palearctic_BSMcontrol_output_2my_full.RDS')
BSMoutput.palearctic.control.rates.mammals<-lapply(BSMoutput.palearctic.control.mammals,function(x)x[[1]])
BSMoutput.palearctic.control.events.mammals<-lapply(BSMoutput.palearctic.control.mammals,function(x)x[[2]])

cat('getting rates/events for birds','\n')
results.BSM.afrotrop.real.birds<-readRDS('./output/birds/immigration/whole_realms/afrotrop/afrotrop.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.afrotrop.real.birds<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.afrotrop.real.birds[[2]],name='afrotrop',speciation.rate.treefile='./output/birds/trees/afrotrop_speciationrates.tree')
BSMoutput.afrotrop.control.birds<-readRDS('./output/birds/immigration/controls/afrotrop/afrotrop_BSMcontrol_output_2my_full.RDS')
BSMoutput.afrotrop.control.rates.birds<-lapply(BSMoutput.afrotrop.control.birds,function(x)x[[1]])
BSMoutput.afrotrop.control.events.birds<-lapply(BSMoutput.afrotrop.control.birds,function(x)x[[2]])

results.BSM.austral.real.birds<-readRDS('./output/birds/immigration/whole_realms/austral/austral.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.austral.real.birds<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.austral.real.birds[[2]],name='austral',speciation.rate.treefile='./output/birds/trees/austral_speciationrates.tree')
BSMoutput.austral.control.birds<-readRDS('./output/birds/immigration/controls/austral/austral_BSMcontrol_output_2my_full.RDS')
BSMoutput.austral.control.rates.birds<-lapply(BSMoutput.austral.control.birds,function(x)x[[1]])
BSMoutput.austral.control.events.birds<-lapply(BSMoutput.austral.control.birds,function(x)x[[2]])

results.BSM.indo.real.birds<-readRDS('./output/birds/immigration/whole_realms/indo/indo.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.indo.real.birds<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.indo.real.birds[[2]],name='indo',speciation.rate.treefile='./output/birds/trees/indo_speciationrates.tree')
BSMoutput.indo.control.birds<-readRDS('./output/birds/immigration/controls/indo/indo_BSMcontrol_output_2my_full.RDS')
BSMoutput.indo.control.rates.birds<-lapply(BSMoutput.indo.control.birds,function(x)x[[1]])
BSMoutput.indo.control.events.birds<-lapply(BSMoutput.indo.control.birds,function(x)x[[2]])

results.BSM.nearctic.real.birds<-readRDS('./output/birds/immigration/whole_realms/nearctic/nearctic.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.nearctic.real.birds<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.nearctic.real.birds[[2]],name='nearctic',speciation.rate.treefile='./output/birds/trees/nearctic_speciationrates.tree')
BSMoutput.nearctic.control.birds<-readRDS('./output/birds/immigration/controls/nearctic/nearctic_BSMcontrol_output_2my_full.RDS')
BSMoutput.nearctic.control.rates.birds<-lapply(BSMoutput.nearctic.control.birds,function(x)x[[1]])
BSMoutput.nearctic.control.events.birds<-lapply(BSMoutput.nearctic.control.birds,function(x)x[[2]])

results.BSM.neotrop.real.birds<-readRDS('./output/birds/immigration/whole_realms/neotrop/neotrop.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.neotrop.real.birds<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.neotrop.real.birds[[2]],name='neotrop',speciation.rate.treefile='./output/birds/trees/neotrop_speciationrates.tree')
BSMoutput.neotrop.control.birds<-readRDS('./output/birds/immigration/controls/neotrop/neotrop_BSMcontrol_output_2my_full.RDS')
BSMoutput.neotrop.control.rates.birds<-lapply(BSMoutput.neotrop.control.birds,function(x)x[[1]])
BSMoutput.neotrop.control.events.birds<-lapply(BSMoutput.neotrop.control.birds,function(x)x[[2]])

results.BSM.palearctic.real.birds<-readRDS('./output/birds/immigration/whole_realms/palearctic/palearctic.whole_realms_7areas_inhotoutrealm_BSM.RDS')
BSMoutput.palearctic.real.birds<-get_BSM_BAMM_fullrates_events_2my_object(results.BSM=results.BSM.palearctic.real.birds[[2]],name='palearctic',speciation.rate.treefile='./output/birds/trees/palearctic_speciationrates.tree')
BSMoutput.palearctic.control.birds<-readRDS('./output/birds/immigration/controls/palearctic/palearctic_BSMcontrol_output_2my_full.RDS')
BSMoutput.palearctic.control.rates.birds<-lapply(BSMoutput.palearctic.control.birds,function(x)x[[1]])
BSMoutput.palearctic.control.events.birds<-lapply(BSMoutput.palearctic.control.birds,function(x)x[[2]])

cat('plotting, outputs in ./output/mammals/plots/','\n')
pdf('./output/mammals/plots/FigS5_mambirds_realvssimulated_insitu.hot_nofixedyaxis.pdf',width=10,height=7)
par(mfrow=c(2,3))
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.afrotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.afrotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.afrotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.afrotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.afrotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.afrotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.afrotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.afrotrop.control.events.birds,age=24,name='afrotrop',plots='insitu.hot.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.austral.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.austral.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.austral.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.austral.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.austral.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.austral.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.austral.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.austral.control.events.birds,age=24,name='austral',plots='insitu.hot.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.indo.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.indo.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.indo.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.indo.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.indo.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.indo.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.indo.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.indo.control.events.birds,age=24,name='indo',plots='insitu.hot.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.nearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.nearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.nearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.nearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.nearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.nearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.nearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.nearctic.control.events.birds,age=24,name='nearctic',plots='insitu.hot.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.neotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.neotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.neotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.neotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.neotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.neotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.neotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.neotrop.control.events.birds,age=24,name='neotrop',plots='insitu.hot.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.palearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.palearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.palearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.palearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.palearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.palearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.palearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.palearctic.control.events.birds,age=24,name='palearctic',plots='insitu.hot.rates.BAMM')
dev.off()

pdf('./output/mammals/plots/FigS6_mambirds_realvssimulated_insitu.realm_nofixedyaxis.pdf',width=10,height=7)
par(mfrow=c(2,3))
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.afrotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.afrotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.afrotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.afrotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.afrotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.afrotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.afrotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.afrotrop.control.events.birds,age=24,name='afrotrop',plots='insitu.realm.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.austral.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.austral.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.austral.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.austral.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.austral.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.austral.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.austral.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.austral.control.events.birds,age=24,name='austral',plots='insitu.realm.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.indo.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.indo.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.indo.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.indo.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.indo.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.indo.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.indo.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.indo.control.events.birds,age=24,name='indo',plots='insitu.realm.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.nearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.nearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.nearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.nearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.nearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.nearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.nearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.nearctic.control.events.birds,age=24,name='nearctic',plots='insitu.realm.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.neotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.neotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.neotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.neotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.neotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.neotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.neotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.neotrop.control.events.birds,age=24,name='neotrop',plots='insitu.realm.rates.BAMM')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.palearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.palearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.palearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.palearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.palearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.palearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.palearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.palearctic.control.events.birds,age=24,name='palearctic',plots='insitu.realm.rates.BAMM')
dev.off()

pdf('./output/mammals/plots/FigS7_mambirds_realvssimulated_meanhotintorealmdiff_nofixedyaxis.pdf',width=10,height=7)
par(mfrow=c(2,3))
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.afrotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.afrotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.afrotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.afrotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.afrotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.afrotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.afrotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.afrotrop.control.events.birds,age=26,name='afrotrop',plots='hot.into.realm.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.austral.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.austral.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.austral.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.austral.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.austral.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.austral.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.austral.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.austral.control.events.birds,age=26,name='austral',plots='hot.into.realm.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.indo.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.indo.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.indo.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.indo.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.indo.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.indo.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.indo.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.indo.control.events.birds,age=26,name='indo',plots='hot.into.realm.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.nearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.nearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.nearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.nearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.nearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.nearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.nearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.nearctic.control.events.birds,age=26,name='nearctic',plots='hot.into.realm.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.neotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.neotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.neotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.neotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.neotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.neotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.neotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.neotrop.control.events.birds,age=26,name='neotrop',plots='hot.into.realm.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.palearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.palearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.palearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.palearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.palearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.palearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.palearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.palearctic.control.events.birds,age=26,name='palearctic',plots='hot.into.realm.diff')
dev.off()

pdf('./output/mammals/plots/FigS8_mambirds_realvssimulated_meanrealmintohotdiff_nofixedyaxis.pdf',width=10,height=7)
par(mfrow=c(2,3))
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.afrotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.afrotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.afrotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.afrotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.afrotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.afrotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.afrotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.afrotrop.control.events.birds,age=26,name='afrotrop',plots='realm.into.hot.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.austral.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.austral.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.austral.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.austral.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.austral.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.austral.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.austral.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.austral.control.events.birds,age=26,name='austral',plots='realm.into.hot.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.indo.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.indo.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.indo.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.indo.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.indo.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.indo.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.indo.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.indo.control.events.birds,age=26,name='indo',plots='realm.into.hot.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.nearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.nearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.nearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.nearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.nearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.nearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.nearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.nearctic.control.events.birds,age=26,name='nearctic',plots='realm.into.hot.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.neotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.neotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.neotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.neotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.neotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.neotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.neotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.neotrop.control.events.birds,age=26,name='neotrop',plots='realm.into.hot.diff')
plot_rates_events_realvscontrol_diffmeans_mambirds_nofixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.palearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.palearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.palearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.palearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.palearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.palearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.palearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.palearctic.control.events.birds,age=26,name='palearctic',plots='realm.into.hot.diff')
dev.off()

cat('calculating differences in colonisation times for mammals','\n')
afrotrop.ages.realm.colonisation.mammals<-unlist(lapply(BSMoutput.afrotrop.real.mammals[[3]],function(x) length(x)-which(x>0)[1]))
afrotrop.ages.hot.colonisation.mammals<-unlist(lapply(BSMoutput.afrotrop.real.mammals[[4]],function(x) length(x)-which(x>0)[1]))
afrotrop.diff.ages.hot.minus.realm.colonisation.mammals<-afrotrop.ages.hot.colonisation.mammals-afrotrop.ages.realm.colonisation.mammals
ages.afrotrop.realm.colonisation.control.mammals<-lapply(BSMoutput.afrotrop.control.mammals,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.afrotrop.hot.colonisation.control.mammals<-lapply(BSMoutput.afrotrop.control.mammals,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
afrotrop.diff.ages.hot.minus.realm.colonisation.mammals.control<-mapply('-',ages.afrotrop.hot.colonisation.control.mammals,ages.afrotrop.realm.colonisation.control.mammals,SIMPLIFY=FALSE)
wilcox.afrotrop.mammals<-wilcox.test(afrotrop.diff.ages.hot.minus.realm.colonisation.mammals,unlist(afrotrop.diff.ages.hot.minus.realm.colonisation.mammals.control),conf.int = T)

austral.ages.realm.colonisation.mammals<-unlist(lapply(BSMoutput.austral.real.mammals[[3]],function(x) length(x)-which(x>0)[1]))
austral.ages.hot.colonisation.mammals<-unlist(lapply(BSMoutput.austral.real.mammals[[4]],function(x) length(x)-which(x>0)[1]))
austral.diff.ages.hot.minus.realm.colonisation.mammals<-austral.ages.hot.colonisation.mammals-austral.ages.realm.colonisation.mammals
ages.austral.realm.colonisation.control.mammals<-lapply(BSMoutput.austral.control.mammals,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.austral.hot.colonisation.control.mammals<-lapply(BSMoutput.austral.control.mammals,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
austral.diff.ages.hot.minus.realm.colonisation.mammals.control<-mapply('-',ages.austral.hot.colonisation.control.mammals,ages.austral.realm.colonisation.control.mammals,SIMPLIFY=FALSE)
wilcox.austral.mammals<-wilcox.test(austral.diff.ages.hot.minus.realm.colonisation.mammals,unlist(austral.diff.ages.hot.minus.realm.colonisation.mammals.control),conf.int = T)

indo.ages.realm.colonisation.mammals<-unlist(lapply(BSMoutput.indo.real.mammals[[3]],function(x) length(x)-which(x>0)[1]))
indo.ages.hot.colonisation.mammals<-unlist(lapply(BSMoutput.indo.real.mammals[[4]],function(x) length(x)-which(x>0)[1]))
indo.diff.ages.hot.minus.realm.colonisation.mammals<-indo.ages.hot.colonisation.mammals-indo.ages.realm.colonisation.mammals
ages.indo.realm.colonisation.control.mammals<-lapply(BSMoutput.indo.control.mammals,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.indo.hot.colonisation.control.mammals<-lapply(BSMoutput.indo.control.mammals,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
indo.diff.ages.hot.minus.realm.colonisation.mammals.control<-mapply('-',ages.indo.hot.colonisation.control.mammals,ages.indo.realm.colonisation.control.mammals,SIMPLIFY=FALSE)
wilcox.indo.mammals<-wilcox.test(indo.diff.ages.hot.minus.realm.colonisation.mammals,unlist(indo.diff.ages.hot.minus.realm.colonisation.mammals.control),conf.int = T)

nearctic.ages.realm.colonisation.mammals<-unlist(lapply(BSMoutput.nearctic.real.mammals[[3]],function(x) length(x)-which(x>0)[1]))
nearctic.ages.hot.colonisation.mammals<-unlist(lapply(BSMoutput.nearctic.real.mammals[[4]],function(x) length(x)-which(x>0)[1]))
nearctic.diff.ages.hot.minus.realm.colonisation.mammals<-nearctic.ages.hot.colonisation.mammals-nearctic.ages.realm.colonisation.mammals
ages.nearctic.realm.colonisation.control.mammals<-lapply(BSMoutput.nearctic.control.mammals,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.nearctic.hot.colonisation.control.mammals<-lapply(BSMoutput.nearctic.control.mammals,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
nearctic.diff.ages.hot.minus.realm.colonisation.mammals.control<-mapply('-',ages.nearctic.hot.colonisation.control.mammals,ages.nearctic.realm.colonisation.control.mammals,SIMPLIFY=FALSE)
wilcox.nearctic.mammals<-wilcox.test(nearctic.diff.ages.hot.minus.realm.colonisation.mammals,unlist(nearctic.diff.ages.hot.minus.realm.colonisation.mammals.control),conf.int = T)

neotrop.ages.realm.colonisation.mammals<-unlist(lapply(BSMoutput.neotrop.real.mammals[[3]],function(x) length(x)-which(x>0)[1]))
neotrop.ages.hot.colonisation.mammals<-unlist(lapply(BSMoutput.neotrop.real.mammals[[4]],function(x) length(x)-which(x>0)[1]))
neotrop.diff.ages.hot.minus.realm.colonisation.mammals<-neotrop.ages.hot.colonisation.mammals-neotrop.ages.realm.colonisation.mammals
ages.neotrop.realm.colonisation.control.mammals<-lapply(BSMoutput.neotrop.control.mammals,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.neotrop.hot.colonisation.control.mammals<-lapply(BSMoutput.neotrop.control.mammals,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
neotrop.diff.ages.hot.minus.realm.colonisation.mammals.control<-mapply('-',ages.neotrop.hot.colonisation.control.mammals,ages.neotrop.realm.colonisation.control.mammals,SIMPLIFY=FALSE)
wilcox.neotrop.mammals<-wilcox.test(neotrop.diff.ages.hot.minus.realm.colonisation.mammals,unlist(neotrop.diff.ages.hot.minus.realm.colonisation.mammals.control),conf.int = T)


palearctic.ages.realm.colonisation.mammals<-unlist(lapply(BSMoutput.palearctic.real.mammals[[3]],function(x) length(x)-which(x>0)[1]))
palearctic.ages.hot.colonisation.mammals<-unlist(lapply(BSMoutput.palearctic.real.mammals[[4]],function(x) length(x)-which(x>0)[1]))
palearctic.diff.ages.hot.minus.realm.colonisation.mammals<-palearctic.ages.hot.colonisation.mammals-palearctic.ages.realm.colonisation.mammals
ages.palearctic.realm.colonisation.control.mammals<-lapply(BSMoutput.palearctic.control.mammals,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.palearctic.hot.colonisation.control.mammals<-lapply(BSMoutput.palearctic.control.mammals,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
palearctic.diff.ages.hot.minus.realm.colonisation.mammals.control<-mapply('-',ages.palearctic.hot.colonisation.control.mammals,ages.palearctic.realm.colonisation.control.mammals,SIMPLIFY=FALSE)


wilcox.palearctic.mammals<-wilcox.test(palearctic.diff.ages.hot.minus.realm.colonisation.mammals,unlist(palearctic.diff.ages.hot.minus.realm.colonisation.mammals.control),conf.int = T)
diff.ages.hot.minus.realm.colonisation.mammals.list<-list(afrotrop.diff.ages.hot.minus.realm.colonisation.mammals,austral.diff.ages.hot.minus.realm.colonisation.mammals,indo.diff.ages.hot.minus.realm.colonisation.mammals,nearctic.diff.ages.hot.minus.realm.colonisation.mammals,neotrop.diff.ages.hot.minus.realm.colonisation.mammals,palearctic.diff.ages.hot.minus.realm.colonisation.mammals)
diff.ages.hot.minus.realm.colonisation.mammals.control.list<-list(afrotrop.diff.ages.hot.minus.realm.colonisation.mammals.control,austral.diff.ages.hot.minus.realm.colonisation.mammals.control,indo.diff.ages.hot.minus.realm.colonisation.mammals.control,nearctic.diff.ages.hot.minus.realm.colonisation.mammals.control,neotrop.diff.ages.hot.minus.realm.colonisation.mammals.control,palearctic.diff.ages.hot.minus.realm.colonisation.mammals.control)
wilcox.results.mammals<-list(wilcox.afrotrop.mammals,wilcox.austral.mammals,wilcox.indo.mammals,wilcox.nearctic.mammals,wilcox.neotrop.mammals,wilcox.palearctic.mammals)
wilcox.results.mammals<-lapply(wilcox.results.mammals,function(x)c(x$conf.int[1],x$conf.int[1],x$estimate,x$conf.int[2],x$conf.int[2]))
pdf('./output/mammals/plots/FigS9_mammals_colonisationhotminusnonhot_realvssimulated.pdf')
bxp(list(stats=matrix(unlist(wilcox.results.mammals),5,6),n=rep(10,length(wilcox.results.mammals))),xaxt='n',main='difference Hot-NonHot colonisation age real vs simulated',ylab='diff in hotspot-non hotspot colonisation age real vs simulated')
axis(1,at=c(1:length(wilcox.results.mammals)),labels=c('Afro','Austral','Indo','Nearctic','Neotrop','Palearctic'))
abline(h=0,lty=2)
dev.off()

cat('calculating differences in colonisation times for birds','\n')
afrotrop.ages.realm.colonisation.birds<-unlist(lapply(BSMoutput.afrotrop.real.birds[[3]],function(x) length(x)-which(x>0)[1]))
afrotrop.ages.hot.colonisation.birds<-unlist(lapply(BSMoutput.afrotrop.real.birds[[4]],function(x) length(x)-which(x>0)[1]))
afrotrop.diff.ages.hot.minus.realm.colonisation.birds<-afrotrop.ages.hot.colonisation.birds-afrotrop.ages.realm.colonisation.birds
ages.afrotrop.realm.colonisation.control.birds<-lapply(BSMoutput.afrotrop.control.birds,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.afrotrop.hot.colonisation.control.birds<-lapply(BSMoutput.afrotrop.control.birds,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
afrotrop.diff.ages.hot.minus.realm.colonisation.birds.control<-mapply('-',ages.afrotrop.hot.colonisation.control.birds,ages.afrotrop.realm.colonisation.control.birds,SIMPLIFY=FALSE)
wilcox.afrotrop.birds<-wilcox.test(afrotrop.diff.ages.hot.minus.realm.colonisation.birds,unlist(afrotrop.diff.ages.hot.minus.realm.colonisation.birds.control),conf.int = T)

austral.ages.realm.colonisation.birds<-unlist(lapply(BSMoutput.austral.real.birds[[3]],function(x) length(x)-which(x>0)[1]))
austral.ages.hot.colonisation.birds<-unlist(lapply(BSMoutput.austral.real.birds[[4]],function(x) length(x)-which(x>0)[1]))
austral.diff.ages.hot.minus.realm.colonisation.birds<-austral.ages.hot.colonisation.birds-austral.ages.realm.colonisation.birds
ages.austral.realm.colonisation.control.birds<-lapply(BSMoutput.austral.control.birds,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.austral.hot.colonisation.control.birds<-lapply(BSMoutput.austral.control.birds,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
austral.diff.ages.hot.minus.realm.colonisation.birds.control<-mapply('-',ages.austral.hot.colonisation.control.birds,ages.austral.realm.colonisation.control.birds,SIMPLIFY=FALSE)
wilcox.austral.birds<-wilcox.test(austral.diff.ages.hot.minus.realm.colonisation.birds,unlist(austral.diff.ages.hot.minus.realm.colonisation.birds.control),conf.int = T)

indo.ages.realm.colonisation.birds<-unlist(lapply(BSMoutput.indo.real.birds[[3]],function(x) length(x)-which(x>0)[1]))
indo.ages.hot.colonisation.birds<-unlist(lapply(BSMoutput.indo.real.birds[[4]],function(x) length(x)-which(x>0)[1]))
indo.diff.ages.hot.minus.realm.colonisation.birds<-indo.ages.hot.colonisation.birds-indo.ages.realm.colonisation.birds
ages.indo.realm.colonisation.control.birds<-lapply(BSMoutput.indo.control.birds,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.indo.hot.colonisation.control.birds<-lapply(BSMoutput.indo.control.birds,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
indo.diff.ages.hot.minus.realm.colonisation.birds.control<-mapply('-',ages.indo.hot.colonisation.control.birds,ages.indo.realm.colonisation.control.birds,SIMPLIFY=FALSE)
wilcox.indo.birds<-wilcox.test(indo.diff.ages.hot.minus.realm.colonisation.birds,unlist(indo.diff.ages.hot.minus.realm.colonisation.birds.control),conf.int = T)

nearctic.ages.realm.colonisation.birds<-unlist(lapply(BSMoutput.nearctic.real.birds[[3]],function(x) length(x)-which(x>0)[1]))
nearctic.ages.hot.colonisation.birds<-unlist(lapply(BSMoutput.nearctic.real.birds[[4]],function(x) length(x)-which(x>0)[1]))
nearctic.diff.ages.hot.minus.realm.colonisation.birds<-nearctic.ages.hot.colonisation.birds-nearctic.ages.realm.colonisation.birds
ages.nearctic.realm.colonisation.control.birds<-lapply(BSMoutput.nearctic.control.birds,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.nearctic.hot.colonisation.control.birds<-lapply(BSMoutput.nearctic.control.birds,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
nearctic.diff.ages.hot.minus.realm.colonisation.birds.control<-mapply('-',ages.nearctic.hot.colonisation.control.birds,ages.nearctic.realm.colonisation.control.birds,SIMPLIFY=FALSE)
wilcox.nearctic.birds<-wilcox.test(nearctic.diff.ages.hot.minus.realm.colonisation.birds,unlist(nearctic.diff.ages.hot.minus.realm.colonisation.birds.control),conf.int = T)

neotrop.ages.realm.colonisation.birds<-unlist(lapply(BSMoutput.neotrop.real.birds[[3]],function(x) length(x)-which(x>0)[1]))
neotrop.ages.hot.colonisation.birds<-unlist(lapply(BSMoutput.neotrop.real.birds[[4]],function(x) length(x)-which(x>0)[1]))
neotrop.diff.ages.hot.minus.realm.colonisation.birds<-neotrop.ages.hot.colonisation.birds-neotrop.ages.realm.colonisation.birds
ages.neotrop.realm.colonisation.control.birds<-lapply(BSMoutput.neotrop.control.birds,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.neotrop.hot.colonisation.control.birds<-lapply(BSMoutput.neotrop.control.birds,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
neotrop.diff.ages.hot.minus.realm.colonisation.birds.control<-mapply('-',ages.neotrop.hot.colonisation.control.birds,ages.neotrop.realm.colonisation.control.birds,SIMPLIFY=FALSE)
wilcox.neotrop.birds<-wilcox.test(neotrop.diff.ages.hot.minus.realm.colonisation.birds,unlist(neotrop.diff.ages.hot.minus.realm.colonisation.birds.control),conf.int = T)


palearctic.ages.realm.colonisation.birds<-unlist(lapply(BSMoutput.palearctic.real.birds[[3]],function(x) length(x)-which(x>0)[1]))
palearctic.ages.hot.colonisation.birds<-unlist(lapply(BSMoutput.palearctic.real.birds[[4]],function(x) length(x)-which(x>0)[1]))
palearctic.diff.ages.hot.minus.realm.colonisation.birds<-palearctic.ages.hot.colonisation.birds-palearctic.ages.realm.colonisation.birds
ages.palearctic.realm.colonisation.control.birds<-lapply(BSMoutput.palearctic.control.birds,function(x) unlist(lapply(x[[3]], function(x) length(x)-which(x>0)[1])))
ages.palearctic.hot.colonisation.control.birds<-lapply(BSMoutput.palearctic.control.birds,function(x) unlist(lapply(x[[4]], function(x) length(x)-which(x>0)[1])))
palearctic.diff.ages.hot.minus.realm.colonisation.birds.control<-mapply('-',ages.palearctic.hot.colonisation.control.birds,ages.palearctic.realm.colonisation.control.birds,SIMPLIFY=FALSE)


wilcox.palearctic.birds<-wilcox.test(palearctic.diff.ages.hot.minus.realm.colonisation.birds,unlist(palearctic.diff.ages.hot.minus.realm.colonisation.birds.control),conf.int = T)
diff.ages.hot.minus.realm.colonisation.birds.list<-list(afrotrop.diff.ages.hot.minus.realm.colonisation.birds,austral.diff.ages.hot.minus.realm.colonisation.birds,indo.diff.ages.hot.minus.realm.colonisation.birds,nearctic.diff.ages.hot.minus.realm.colonisation.birds,neotrop.diff.ages.hot.minus.realm.colonisation.birds,palearctic.diff.ages.hot.minus.realm.colonisation.birds)
diff.ages.hot.minus.realm.colonisation.birds.control.list<-list(afrotrop.diff.ages.hot.minus.realm.colonisation.birds.control,austral.diff.ages.hot.minus.realm.colonisation.birds.control,indo.diff.ages.hot.minus.realm.colonisation.birds.control,nearctic.diff.ages.hot.minus.realm.colonisation.birds.control,neotrop.diff.ages.hot.minus.realm.colonisation.birds.control,palearctic.diff.ages.hot.minus.realm.colonisation.birds.control)
wilcox.results.birds<-list(wilcox.afrotrop.birds,wilcox.austral.birds,wilcox.indo.birds,wilcox.nearctic.birds,wilcox.neotrop.birds,wilcox.palearctic.birds)
wilcox.results.birds<-lapply(wilcox.results.birds,function(x)c(x$conf.int[1],x$conf.int[1],x$estimate,x$conf.int[2],x$conf.int[2]))
pdf('./output/birds/plots/FigS9_birds_colonisationhotminusnonhot_realvssimulated.pdf')
bxp(list(stats=matrix(unlist(wilcox.results.birds),5,6),n=rep(10,length(wilcox.results.birds))),xaxt='n',main='difference Hot-NonHot colonisation age real vs simulated',ylab='diff in hotspot-non hotspot colonisation age real vs simulated')
axis(1,at=c(1:length(wilcox.results.birds)),labels=c('Afro','Austral','Indo','Nearctic','Neotrop','Palearctic'))
abline(h=0,lty=2)
dev.off()

##pdf('./mambirds_realvssimulated_meanhotintorealmdiff.pdf',width=10,height=7)
##par(mfrow=c(2,3))
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.afrotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.afrotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.afrotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.afrotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.afrotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.afrotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.afrotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.afrotrop.control.events.birds,age=26,name='afrotrop',plots='hot.into.realm.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.austral.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.austral.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.austral.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.austral.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.austral.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.austral.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.austral.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.austral.control.events.birds,age=26,name='austral',plots='hot.into.realm.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.indo.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.indo.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.indo.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.indo.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.indo.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.indo.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.indo.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.indo.control.events.birds,age=26,name='indo',plots='hot.into.realm.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.nearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.nearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.nearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.nearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.nearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.nearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.nearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.nearctic.control.events.birds,age=26,name='nearctic',plots='hot.into.realm.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.neotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.neotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.neotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.neotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.neotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.neotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.neotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.neotrop.control.events.birds,age=26,name='neotrop',plots='hot.into.realm.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.palearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.palearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.palearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.palearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.palearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.palearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.palearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.palearctic.control.events.birds,age=26,name='palearctic',plots='hot.into.realm.diff',ylim=7)
##dev.off()
##
##pdf('./mambirds_realvssimulated_meanrealmintohotdiff.pdf',width=10,height=7)
##par(mfrow=c(2,3))
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.afrotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.afrotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.afrotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.afrotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.afrotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.afrotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.afrotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.afrotrop.control.events.birds,age=26,name='afrotrop',plots='realm.into.hot.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.austral.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.austral.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.austral.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.austral.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.austral.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.austral.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.austral.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.austral.control.events.birds,age=26,name='austral',plots='realm.into.hot.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.indo.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.indo.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.indo.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.indo.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.indo.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.indo.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.indo.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.indo.control.events.birds,age=26,name='indo',plots='realm.into.hot.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.nearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.nearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.nearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.nearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.nearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.nearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.nearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.nearctic.control.events.birds,age=26,name='nearctic',plots='realm.into.hot.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.neotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.neotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.neotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.neotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.neotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.neotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.neotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.neotrop.control.events.birds,age=26,name='neotrop',plots='realm.into.hot.diff',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.palearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.palearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.palearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.palearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.palearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.palearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.palearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.palearctic.control.events.birds,age=26,name='palearctic',plots='realm.into.hot.diff',ylim=7)
##dev.off()
##
##pdf('./mambirds_realvssimulated_insitu.hot.pdf',width=10,height=7)
##par(mfrow=c(2,3))
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.afrotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.afrotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.afrotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.afrotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.afrotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.afrotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.afrotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.afrotrop.control.events.birds,age=26,name='afrotrop',plots='insitu.hot.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.austral.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.austral.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.austral.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.austral.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.austral.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.austral.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.austral.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.austral.control.events.birds,age=26,name='austral',plots='insitu.hot.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.indo.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.indo.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.indo.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.indo.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.indo.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.indo.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.indo.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.indo.control.events.birds,age=26,name='indo',plots='insitu.hot.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.nearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.nearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.nearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.nearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.nearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.nearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.nearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.nearctic.control.events.birds,age=26,name='nearctic',plots='insitu.hot.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.neotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.neotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.neotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.neotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.neotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.neotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.neotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.neotrop.control.events.birds,age=26,name='neotrop',plots='insitu.hot.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.palearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.palearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.palearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.palearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.palearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.palearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.palearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.palearctic.control.events.birds,age=26,name='palearctic',plots='insitu.hot.rates.BAMM',ylim=7)
##dev.off()
##
##pdf('./mambirds_realvssimulated_insitu.realm.pdf',width=10,height=7)
##par(mfrow=c(2,3))
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.afrotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.afrotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.afrotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.afrotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.afrotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.afrotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.afrotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.afrotrop.control.events.birds,age=26,name='afrotrop',plots='insitu.realm.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.austral.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.austral.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.austral.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.austral.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.austral.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.austral.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.austral.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.austral.control.events.birds,age=26,name='austral',plots='insitu.realm.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.indo.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.indo.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.indo.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.indo.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.indo.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.indo.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.indo.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.indo.control.events.birds,age=26,name='indo',plots='insitu.realm.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.nearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.nearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.nearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.nearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.nearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.nearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.nearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.nearctic.control.events.birds,age=26,name='nearctic',plots='insitu.realm.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.neotrop.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.neotrop.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.neotrop.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.neotrop.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.neotrop.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.neotrop.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.neotrop.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.neotrop.control.events.birds,age=26,name='neotrop',plots='insitu.realm.rates.BAMM',ylim=7)
##plot_rates_events_realvscontrol_diffmeans_mambirds_fixedyaxis(BSMoutput.real.rates.mammals=BSMoutput.palearctic.real.mammals[[1]],BSMoutput.real.events.mammals=BSMoutput.palearctic.real.mammals[[2]],BSMoutput.control.rates.mammals=BSMoutput.palearctic.control.rates.mammals,BSMoutput.control.events.mammals=BSMoutput.palearctic.control.events.mammals,BSMoutput.real.rates.birds=BSMoutput.palearctic.real.birds[[1]],BSMoutput.real.events.birds=BSMoutput.palearctic.real.birds[[2]],BSMoutput.control.rates.birds=BSMoutput.palearctic.control.rates.birds,BSMoutput.control.events.birds=BSMoutput.palearctic.control.events.birds,age=26,name='palearctic',plots='insitu.realm.rates.BAMM',ylim=7)
##dev.off()


